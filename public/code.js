"use strict";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function e(e,t,i,n){return new(i||(i=Promise))((function(a,o){function l(e){try{s(n.next(e))}catch(e){o(e)}}function r(e){try{s(n.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(l,r)}s((n=n.apply(e,t||[])).next())}))}let t,i,n,a,o,l,r,s,g,m;figma.showUI(__html__,{themeColors:!0,width:500,height:300});const c=[{type:"SOLID",color:{r:0,g:0,b:0}}],d=[{type:"SOLID",color:{r:1,g:1,b:1}}],f=[{type:"SOLID",color:{r:.5,g:.5,b:.5}}],p=[{type:"SOLID",color:{r:0,g:.5,b:1}}];let A=24,h=24,u=24,T=24,y=4,C=4,E=8,I=4,x=8,R=4;figma.ui.onmessage=S=>e(void 0,void 0,void 0,(function*(){"draw"===S.type&&(t=S.data,i=S.bars,n=S.size,a=+S.width,o=+S.height,l=+S.leftMargin,r=S.ticks,s=S.showYAxis,g=S.showHeader,m=S.showValues,yield e(void 0,void 0,void 0,(function*(){yield figma.loadFontAsync({family:"Inter",style:"Regular"}),yield figma.loadFontAsync({family:"Inter",style:"Bold"});const e=Math.max(...t.map(e=>e[n]));console.log(e);const S=figma.createFrame();if(S.name="Chart",S.resizeWithoutConstraints(a,300),S.layoutMode="VERTICAL",S.itemSpacing=24,S.paddingTop=A,S.paddingRight=h,S.paddingBottom=u,S.paddingLeft=T,S.x=figma.currentPage.selection.length>0?figma.currentPage.selection[figma.currentPage.selection.length-1].x+figma.currentPage.selection[figma.currentPage.selection.length-1].width+80:0,g){const e=figma.createFrame();e.name="Header",e.layoutMode="VERTICAL",e.layoutAlign="STRETCH",e.itemSpacing=8;const t=figma.createText();t.name="Title",t.characters="Lorem ipsum dolor sit amet",t.fontSize=24,t.fontName={family:"Inter",style:"Bold"},t.layoutAlign="STRETCH",t.fills=c;const i=figma.createText();i.name="Subtitle",i.characters="Lorem ipsum dolor sit amet, consectetur adipiscing elit",i.fontSize=16,i.fontName={family:"Inter",style:"Regular"},i.layoutAlign="STRETCH",i.fills=f,e.appendChild(t),e.appendChild(i),S.appendChild(e)}const z=figma.createFrame();let M,N,L;z.name="Viz",z.layoutMode="HORIZONTAL",z.primaryAxisSizingMode="FIXED",z.layoutAlign="STRETCH",z.primaryAxisAlignItems="CENTER",z.counterAxisAlignItems="MAX",z.resize(a-h-T,o),z.itemSpacing=0,z.paddingRight=24,z.paddingLeft=24,z.itemReverseZIndex=!0,z.clipsContent=!1,z.fills=[];for(let a=0;a<t.length;a++){const o=figma.createFrame();o.name="Column",o.layoutMode="VERTICAL",o.layoutAlign="STRETCH",o.counterAxisAlignItems="CENTER",o.primaryAxisSizingMode="FIXED",o.counterAxisSizingMode="AUTO",o.itemSpacing=8,o.fills=[],o.clipsContent=!1,M=Math.min(48,z.width/t.length),o.resize(M,z.height);let l=[];t.forEach(e=>{let t=figma.createText();t.characters=e[i].toString(),t.fontSize=12,t.fontName={family:"Inter",style:"Regular"},t.resize(M,40),t.textAutoResize="HEIGHT",l.push(t.height),t.remove()});let r=[];t.forEach(e=>{let t=figma.createText();t.characters=e[i].toString(),t.fontSize=14,t.fontName={family:"Inter",style:"Bold"},t.resize(M,40),t.textAutoResize="HEIGHT",r.push(t.height),t.remove()}),N=Math.max(...l),L=Math.max(...r);const s=figma.createText();s.name="Label",s.characters=t[a][i],s.fontSize=12,s.fontName={family:"Inter",style:"Regular"},s.fills=c,s.textAlignHorizontal="CENTER",s.textAlignVertical="TOP",s.textTruncation="ENDING",s.resize(M,N),s.layoutAlign="STRETCH";const g=figma.createFrame();g.name="Bar Container",g.layoutMode="VERTICAL",g.counterAxisAlignItems="CENTER",g.primaryAxisAlignItems="MAX",g.layoutAlign="STRETCH",g.layoutGrow=1,g.primaryAxisSizingMode="FIXED",g.counterAxisSizingMode="AUTO",g.fills=[],g.clipsContent=!1,g.itemSpacing=8,g.paddingRight=y,g.paddingLeft=C,g.strokes=c,g.strokeBottomWeight=2,g.strokeAlign="CENTER";const f=figma.createFrame();if(f.name="Bar",f.layoutMode="VERTICAL",f.counterAxisAlignItems="CENTER",f.primaryAxisAlignItems="MIN",f.itemSpacing=8,f.resize(M-R-I,(z.height-8-L)*t[a][n]/e),f.layoutAlign="STRETCH",f.fills=p,f.paddingTop=E,f.paddingRight=I,f.paddingBottom=x,f.paddingLeft=R,m){const e=figma.createText();e.name="Value",e.characters=t[a][n].toString(),e.fontSize=14,e.fontName={family:"Inter",style:"Bold"},e.fills=c,e.strokes=d,e.strokeWeight=2,e.strokeAlign="OUTSIDE",e.strokeJoin="ROUND",e.textAlignHorizontal="CENTER",e.textAlignVertical="CENTER",g.appendChild(e),g.appendChild(f)}else g.appendChild(f);o.appendChild(g),o.appendChild(s),z.appendChild(o)}if(s){const e=figma.createFrame();e.name="Ticks",e.layoutMode="VERTICAL",e.counterAxisAlignItems="MAX",e.primaryAxisAlignItems="SPACE_BETWEEN",e.primaryAxisSizingMode="FIXED",e.counterAxisSizingMode="AUTO",e.clipsContent=!1,e.fills=[],e.resize(16,z.height-N-8-(m?L+8:0));const i=[...r].reverse();for(let n=0;n<i.length;n++){const a=figma.createFrame();a.name="Tick",a.layoutMode="HORIZONTAL",a.itemSpacing=4,a.primaryAxisAlignItems="MAX",a.counterAxisAlignItems="CENTER",a.clipsContent=!1,a.resize(16,1);const o=figma.createLine();o.name="Line",o.resize(t.length*M,0),o.strokes=f,o.strokeWeight=1,o.strokeAlign="CENTER",a.appendChild(o);const l=figma.createText();l.name="Label",l.characters=i[n].toString(),l.fontSize=10,l.fontName={family:"Inter",style:"Regular"},l.fills=f,l.textAlignHorizontal="CENTER",a.appendChild(l),e.appendChild(a)}const a=figma.createFrame();a.name="Tick Frame Container",a.layoutMode="VERTICAL",a.layoutAlign="STRETCH",a.primaryAxisSizingMode="FIXED",a.counterAxisSizingMode="AUTO",a.primaryAxisAlignItems="MAX",a.fills=[],a.clipsContent=!1,a.paddingBottom=N+8,a.appendChild(e),z.appendChild(a);const o=figma.createFrame();o.name="Axis Label Container",o.layoutMode="HORIZONTAL",o.layoutAlign="STRETCH",o.primaryAxisSizingMode="AUTO",o.counterAxisSizingMode="AUTO",o.primaryAxisAlignItems="CENTER",o.counterAxisAlignItems="CENTER",o.paddingBottom=l+8,o.fills=[],o.paddingLeft=8;const s=figma.createText();s.characters=n,s.fontSize=12,s.fills=f,s.fontName={family:"Inter",style:"Regular"},s.rotation=90,s.textAutoResize="WIDTH_AND_HEIGHT",o.appendChild(s),z.appendChild(o)}S.appendChild(z),figma.currentPage.appendChild(S),figma.currentPage.selection=[S],figma.viewport.scrollAndZoomIntoView([S])}))),figma.closePlugin()}));
